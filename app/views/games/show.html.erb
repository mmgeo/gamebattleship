<!-- app/views/games/show.html.erb -->
<h2>Game in progress</h2>

<% if flash[:error] %>
  <div class="alert alert-danger"><%= flash[:error] %></div>
<% end %>

<% if flash[:success] %>
  <div class="alert alert-success"><%= flash[:success] %></div>
<% end %>

<%= render 'board', game: @game, player: 1 %>
<%= render 'board', game: @game, player: 2 %>

<% if !@game.game_over? %>
  <%= form_with(url: place_ship_game_path(@game), method: "post") do |form| %>
    <%= form.hidden_field :player, value: 1 %>
    <%= form.select :ship_name, options_for_select(Ship.pluck(:name)), prompt: "Select a ship" %>
    <%= form.number_field :x, min: 0, max: 9, placeholder: "X coordinate" %>
    <%= form.number_field :y, min: 0, max: 9, placeholder: "Y coordinate" %>
    <%= form.select :direction, ['horizontal', 'vertical'], prompt: "Select direction" %>
    <%= form.submit "Place Ship" %>
  <% end %>

  <%= form_with(url: fire_game_path(@game), method: "post") do |form| %>
    <%= form.hidden_field :player, value: 1 %>
    <%= form.number_field :x, min: 0, max: 9, placeholder: "X coordinate" %>
    <%= form.number_field :y, min: 0, max: 9, placeholder: "Y coordinate" %>
    <%= form.submit "Fire!" %>
  <% end %>
<% else %>
  <h2>Game Over</h2>
  <% if @game.player_1_ships.all?(&:sunk?) %>
    <h3>Player 2 Wins!</h3>
  <% else %>
    <h3>Player 1 Wins!</h3>
  <% end %>
<% end %>
